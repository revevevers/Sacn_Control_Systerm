%% Define serial communication parameters
% RS232
baudRate = 19200; % Baud rate for the serial communication
serialPortName = 'COM3'; % Replace with your serial port name (e.g., 'COM3' on Windows or '/dev/ttyUSB0' on Linux/Mac)

% Define a 10-byte hexadecimal data packet

% 输入十进制电压值，转化为十六进制提取高位和低位
V = 680;
decimalValue_uint16 = uint16(V);
V1H = bitshift(decimalValue_uint16, -8); % 高 8 位
V1L = bitand(decimalValue_uint16, 255);  % 低 8 位
% 输入十进制频率值，转化为十六进制提取高位和低位
F = 1000;
decimalValue_uint16 = uint16(F);
freqQH = bitshift(decimalValue_uint16, -8); % 高 8 位
freqQL = bitand(decimalValue_uint16, 255);  % 低 8 位

online_download = [0x01, 0x11, 0x00, 0x00, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
online_download_close = [0x01, 0x11, 0x00, 0x11, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
V_download = [0x01, 0x22, V1H, V1L, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
F_download = [0x01, 0x44, freqQH, freqQL, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
stand_by = [0x01, 0x55, 0x00, 0x55, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
stand_by_close = [0x01, 0x55, 0x00, 0x00, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
Flash = [0x01, 0x66, 0x00, 0x66, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
Flash_close = [0x01, 0x66, 0x00, 0x00, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
QSwitch = [0x01, 0xbb, 0x00, 0xbb, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];
QSwitch_close = [0x01, 0xbb, 0x00, 0x00, 0x00, 0x00, 0xcc, 0x33, 0xc3, 0x3c];

%% Send the data packet to the serial port
% 联机下传-》设置参数（或者提前在控制面板设置好）-》stand_by-》Flash-》QSwitch-》QSwitch_close-》Flash_close-》stand_by_close

dataPacket = online_download;
% 创建并打开串口对象
s = serialport(serialPort, baudRate);
fprintf('串口已打开：%s\n', serialPort);

send_serial_data(s, dataPacket);

% 清理串口对象
clear s;